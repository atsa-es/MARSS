<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Utility functions for MARSS functions in the MARSS-package.  These are not exported but can be accessed using the MARSS::: prefix."><title>Utility Functions — utility.functions • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Utility Functions — utility.functions"><meta property="og:description" content="Utility functions for MARSS functions in the MARSS-package.  These are not exported but can be accessed using the MARSS::: prefix."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Utility Functions</h1>
      
      <div class="d-none name"><code>utility_functions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Utility functions for MARSS functions in the <code><a href="MARSS-package.html">MARSS-package</a></code>.  These are not exported but can be accessed using the <code>MARSS:::</code> prefix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vector.all.equal</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">convert.model.mat</span><span class="op">(</span><span class="va">param.matrix</span><span class="op">)</span></span>
<span><span class="fu">fixed.free.to.formula</span><span class="op">(</span><span class="va">fixed</span>,<span class="va">free</span>,<span class="va">dim</span><span class="op">)</span></span>
<span><span class="fu">fully.spec.x</span><span class="op">(</span><span class="va">Z</span>, <span class="va">R</span><span class="op">)</span></span>
<span><span class="fu">Imat</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">is.blockdiag</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">is.design</span><span class="op">(</span><span class="va">x</span>, strict<span class="op">=</span><span class="cn">TRUE</span>, dim<span class="op">=</span><span class="cn">NULL</span>, zero.rows.ok<span class="op">=</span><span class="cn">FALSE</span>, zero.cols.ok<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">is.diagonal</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">is.equaltri</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">is.fixed</span><span class="op">(</span><span class="va">x</span>, by.row<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">is.identity</span><span class="op">(</span><span class="va">x</span>, dim<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">is.timevarying</span><span class="op">(</span><span class="va">MLEobj</span><span class="op">)</span></span>
<span><span class="fu">is.solvable</span><span class="op">(</span><span class="va">A</span>,y<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">is.validvarcov</span><span class="op">(</span><span class="va">x</span>, method<span class="op">=</span><span class="st">"kem"</span><span class="op">)</span></span>
<span><span class="fu">is.wholenumber</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu">is.unitcircle</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu">is.zero</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">makediag</span><span class="op">(</span><span class="va">x</span>, nrow<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu">marssMODEL.to.list</span><span class="op">(</span><span class="va">MODELobj</span><span class="op">)</span></span>
<span><span class="fu">matrix.power</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu">mystrsplit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">parmat</span><span class="op">(</span><span class="va">MLEobj</span>, elem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"U"</span>, <span class="st">"Q"</span>, <span class="st">"Z"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>, <span class="st">"x0"</span>, <span class="st">"V0"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>, <span class="st">"L"</span><span class="op">)</span>, </span>
<span>    t <span class="op">=</span> <span class="fl">1</span>, dims <span class="op">=</span> <span class="cn">NULL</span>, model.loc <span class="op">=</span> <span class="st">"marss"</span><span class="op">)</span></span>
<span><span class="fu">pinv</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">pcholinv</span><span class="op">(</span><span class="va">x</span>, chol <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">pchol</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="fu">rwishart</span><span class="op">(</span><span class="va">nu</span>, <span class="va">V</span><span class="op">)</span></span>
<span><span class="fu">sub3D</span><span class="op">(</span><span class="va">x</span>,t<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">takediag</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">unvec</span><span class="op">(</span><span class="va">x</span>, dim<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">vec</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x, A, y</dt>
<dd><p>A matrix (or vector for '<code>makediag</code>' or string for '<code>mystrsplit</code>'.).</p></dd>

  <dt> Z, R </dt>
<dd><p><code>Z</code> matrix and <code>R</code> matrix</p></dd>

  <dt>na.rm</dt>
<dd><p>How to treat NAs in the block diag test.</p></dd>

  <dt>dim, dims</dt>
<dd><p>Matrix dimensions. Some functions will take the vec of a matrix.  In this case, the optional dim arg specifies the matrix dimensions.</p></dd>

  <dt>fixed</dt>
<dd><p>A fixed matrix per the MARSS specification for fixed matrix syntax.</p></dd>

  <dt>free</dt>
<dd><p>A free matrix per the MARSS specification for free matrix syntax.</p></dd>

  <dt>nrow</dt>
<dd><p>Number of rows.</p></dd>

  <dt>tol</dt>
<dd><p>Tolerance.</p></dd>

  <dt>method</dt>
<dd><p>kem or BFGS.  Used to add extra test for MARSSoptim().</p></dd>

  <dt>t</dt>
<dd><p>The time index or third dimension of a 3D matrix</p></dd>

  <dt>nu, V</dt>
<dd><p>Parameters of a Wishart distribution.</p></dd>

  <dt>param.matrix</dt>
<dd><p>The list matrix version of a time-invariant MARSS model.</p></dd>

  <dt>n</dt>
<dd><p>An integer for the power function.</p></dd>

  <dt> zero.rows.ok, zero.cols.ok </dt>
<dd><p>Means the design matrix can have all zero rows or columns.</p></dd>

  <dt> strict </dt>
<dd><p>Specifies whether the design matrix must be only 0s and 1s.</p></dd>

  <dt> by.row </dt>
<dd><p>For is.fixed, reports whether is.fixed by row rather than for the whole matrix.</p></dd>

  <dt> chol </dt>
<dd><p>For pcholinv, use <code>chol2inv(chol())</code> if TRUE otherwise use solve().</p></dd>

  <dt> MLEobj</dt>
<dd><p>A <code><a href="marssMLE-class.html">marssMLE</a></code> object.</p></dd>

  <dt> MODELobj</dt>
<dd><p>A <code><a href="marssMODEL-class.html">marssMODEL</a></code> object.</p></dd>

  <dt> elem </dt>
<dd><p>The parameter matrix of a marss model to return.</p></dd>

  <dt> model.loc </dt>
<dd><p>Whether to use the marss or model marssMODEL in the <code><a href="marssMLE-class.html">marssMLE</a></code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p><code>is...</code> tests for various matrix properties.  isDiagonal() from the Matrix package is used to test numeric matrices for diagonality.  is.diagonal() is only used to determine if list matrices (that combine numeric and character values) are diagonal. is.zero tests for near zeroness and gives TRUE for is.zero((.5-.3)-(.3-.1)) unlike ==0.</p></li>
<li><p><code>is.timevarying(MLEobj)</code> returns a list of which parameters are time-varying.</p></li>
<li><p><code>vec(x)</code> creates a column vector from a matrix per the standard vec math function.</p></li>
<li><p><code>unvec(c,dim)</code> takes the vector c and creates a matrix with the specified dimensions.</p></li>
<li><p><code>Imat(nrow)</code> returns the identity matrix of dimension nrow.</p></li>
<li><p><code> fixed.free.to.formula </code> takes a fixed and free pair and constructs a list matrix (or array if time-varying) with formulas in each matrix element.</p></li>
<li><p><code> marssMODEL.to.list </code> uses <code> fixed.free.to.formula </code> on all the elements of a <code><a href="marssMODEL-class.html">marssMODEL</a></code> to create a list that can be passed to <code><a href="MARSS.html">MARSS</a>()</code> as the <code>model</code> argument.</p></li>
<li><p><code> convert.model.mat </code> takes a list matrix with formulas in each element and converts to a fixed/free pair.</p></li>
<li><p><code> sub3D </code> returns a 2D matrix after subsetting a 3D matrix on the third (time) dimension. Ensures that R always returns a matrix.</p></li>
<li><p><code> mystrsplit </code> is a customized string splitter used by <code>convert.model.mat</code>.</p></li>
<li><p><code> rwishart </code> generates random draws from a wishart distribution.</p></li>
<li><p><code> matrix.power </code> is a faster way to get the n-th power of a matrix.</p></li>
<li><p><code> pinv </code> is the pseudoinverse based on singular value decomposition PInv=UD^+V' where a diagonal matrix with non-zero diagonal values of D (from svd) replaced with 1/D.</p></li>
<li><p><code> pcholinv </code> is the inverse based on the Cholesky decomposition but modified to allow 0s on the diagonal of x (with corresponding 0 row/column).  These appear as 0 row/columns in the returned inverse.</p></li>
<li><p><code> pchol </code> returns the Cholesky decomposition but modified to allow 0s on the diagonal of x (with corresponding 0 row/column).</p></li>
<li><p><code> is.solvable </code> returns information on the solvability of the linear system y=Ax using the SVD decomposition.</p></li>
<li><p><code> vector.all.equal </code> tests if the all the elements in a vector, matrix, or array are all equal.  Works on list matrices too.</p></li>
<li><p><code> parmat </code> constructs the parameter matrix with both the fixed and free values from the vectorized form in a <code><a href="marssMLE-class.html">marssMLE</a></code> object.  Users should use <code><a href="coef_marssMLE.html">coef</a></code>.</p></li>
<li><p><code> fully.spec.x </code> returns a list with 0 and 1 showing which x are fully specified by data when <code>R</code> has zeros on the diagonal. Used by <code><a href="MARSSkf.html">MARSSkfss</a>()</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>See above.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes and Eric Ward, NOAA, Seattle, USA.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

