<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='The argument form="marxss" in a MARSS() function call specifies a MAR-1 model with eXogenous variables model.  This is a MARSS(1) model of the form:
$$\mathbf{x}_{t} = \mathbf{B}_t \mathbf{x}_{t-1} + \mathbf{u}_t + \mathbf{C}_t \mathbf{c}_t + \mathbf{G}_t \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q}_t)$$
$$\mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_t + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R}_t)$$
$$\mathbf{X}_1 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) \textrm{ or } \mathbf{X}_0 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) $$
Note, by default \(\mathbf{V0}\) is a matrix of all zeros and thus \(\mathbf{x}_1\) or \(\mathbf{x}_0\) is treated as an estimated parameter not a diffuse prior.
Note, "marxss" is a model form.  A model form is defined by a collection of form functions discussed in marssMODEL.  These functions are not exported to the user, but are called by MARSS() using the argument form.'><title>Multivariate AR-1 State-space Model with Inputs — MARSS.marxss • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Multivariate AR-1 State-space Model with Inputs — MARSS.marxss"><meta property="og:description" content='The argument form="marxss" in a MARSS() function call specifies a MAR-1 model with eXogenous variables model.  This is a MARSS(1) model of the form:
$$\mathbf{x}_{t} = \mathbf{B}_t \mathbf{x}_{t-1} + \mathbf{u}_t + \mathbf{C}_t \mathbf{c}_t + \mathbf{G}_t \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q}_t)$$
$$\mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_t + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R}_t)$$
$$\mathbf{X}_1 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) \textrm{ or } \mathbf{X}_0 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) $$
Note, by default \(\mathbf{V0}\) is a matrix of all zeros and thus \(\mathbf{x}_1\) or \(\mathbf{x}_0\) is treated as an estimated parameter not a diffuse prior.
Note, "marxss" is a model form.  A model form is defined by a collection of form functions discussed in marssMODEL.  These functions are not exported to the user, but are called by MARSS() using the argument form.'><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multivariate AR-1 State-space Model with Inputs</h1>
      
      <div class="d-none name"><code>MARSS_marxss.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The argument <code>form="marxss"</code> in a <code><a href="MARSS.html">MARSS</a>()</code> function call specifies a MAR-1 model with eXogenous variables model.  This is a MARSS(1) model of the form:
$$\mathbf{x}_{t} = \mathbf{B}_t \mathbf{x}_{t-1} + \mathbf{u}_t + \mathbf{C}_t \mathbf{c}_t + \mathbf{G}_t \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q}_t)$$
$$\mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_t + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R}_t)$$
$$\mathbf{X}_1 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) \textrm{ or } \mathbf{X}_0 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) $$
Note, by default \(\mathbf{V0}\) is a matrix of all zeros and thus \(\mathbf{x}_1\) or \(\mathbf{x}_0\) is treated as an estimated parameter not a diffuse prior.</p>
<p>Note, "marxss" is a model form.  A model form is defined by a collection of form functions discussed in <code><a href="marssMODEL-class.html">marssMODEL</a></code>.  These functions are not exported to the user, but are called by <code><a href="MARSS.html">MARSS</a>()</code> using the argument <code>form</code>.</p>
    </div>


    <div class="section level2">
    <h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h2>
    <p><code>MARSS(y, 
    inits = NULL, 
    model = NULL, 
    miss.value = as.numeric(NA), 
    method = "kem", 
    form = "marxss", 
    fit = TRUE, 
    silent = FALSE, 
    control = NULL, 
    fun.kf = "MARSSkfas", 
    ...)</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The allowed arguments when <code>form="marxss"</code> are 1) the arguments common to all forms: "y" (data), "inits", "control", "method", "form", "fit", "silent", "fun.kf" (see <code><a href="MARSS.html">MARSS</a></code> for information on these arguments) and 2) the argument "model" which is a list describing the MARXSS model (the model list is described below).
See the <a href="https://cran.r-project.org/package=MARSS/vignettes/Quick_Start.pdf" class="external-link">Quick Start Guide</a> guide or the <a href="https://cran.r-project.org/package=MARSS/vignettes/UserGuide.pdf" class="external-link">User Guide</a> for examples.</p>
<p>The argument <code>model</code> must be a list.  The elements in the list specify the structure for the \(\mathbf{B}\), \(\mathbf{u}\), \(\mathbf{C}\), \(\mathbf{c}\), \(\mathbf{Q}\), \(\mathbf{Z}\), \(\mathbf{a}\), \(\mathbf{D}\), \(\mathbf{d}\), \(\mathbf{R}\), \(\mathbf{x}_0\), and \(\mathbf{V}_0\) in the MARXSS model (above).  The list elements can have the following values:</p><ul><li><p><code>Z</code> Default="identity".  A text string, "identity","unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", or "onestate", or a length n vector of factors specifying which of the m hidden state time series correspond to which of the n observation time series.   May be specified as a n x m list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric n x m matrix to use a custom fixed \(\mathbf{Z}\). "onestate" gives a n x 1 matrix of 1s. "identity","unconstrained", "diagonal and unequal", "diagonal and equal", and "equalvarcov" all specify n x n matrices.</p></li>
<li><p><code>B</code> Default="identity".  A text string, "identity", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", "zero". Can also be specified as a list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric m x m matrix to use custom fixed \(\mathbf{B}\), but in this case all the eigenvalues of \(\mathbf{B}\) must fall in the unit circle.</p></li>
<li><p><code>U</code>, <code>x0</code> Default="unconstrained". A text string, "unconstrained", "equal", "unequal" or "zero". May be specified as a m x 1 list matrix for general specification of both fixed and shared elements within the matrix. May also be specified as a numeric m x 1 matrix to use a custom fixed \(\mathbf{u}\) or \(\mathbf{x}_0\). Notice that <code>U</code> is capitalized in the <code>model</code> argument and output lists.</p></li>
<li><p><code>A</code> Default="scaling".  A text string, "scaling","unconstrained", "equal", "unequal" or "zero". May be specified as a  n x 1 list matrix for general specification of both fixed and shared elements within the matrix. May also be specified as a numeric n x 1 matrix to use a custom fixed \(\mathbf{a}\). Care must be taken when specifying <code>A</code> so that the model is not under-constrained and unsolvable model.  The default, "scaling", only applies to \(\mathbf{Z}\) matrices that are design matrices (only 1s and 0s and all rows sum to 1). When a column in \(\mathbf{Z}\) has multiple 1s, the first row in the \(\mathbf{a}\) matrix associated with those \(\mathbf{Z}\) rows is 0 and the other associated \(\mathbf{a}\) rows have an estimated value. This is used to treat \(\mathbf{a}\) as an intercept where one intercept for each \(\mathbf{x}\) (hidden state) is fixed at 0 and any other intercepts associated with that \(\mathbf{x}\) have an estimated intercept.  This ensures a solvable model when \(\mathbf{Z}\) is a design matrix. Note in the model argument and output, <code>A</code> is capitalized.</p></li>
<li><p><code>Q</code> Default="diagonal and unequal".  A text string, "identity", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", "zero". May be specified as a list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric g x g matrix to use a custom fixed matrix. Default value of g is m, so \(\mathbf{Q}\) is a m x m matrix.  g is the number of columns in \(\mathbf{G}\) (below).</p></li>
<li><p><code>R</code> Default="diagonal and equal".  A text string, "identity", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", "zero". May be specified as a list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric h x h matrix to use a custom fixed matrix. Default value of h is n, so \(\mathbf{R}\) is a n x n matrix.  h is the num of columns in \(\mathbf{H}\) (below).</p></li>
<li><p><code>V0</code> Default="zero".  A text string, "identity", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", "zero". May be specified as a list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric m x m matrix to use a custom fixed matrix.</p></li>
<li><p><code>D</code> and <code>C</code> Default="zero".  A text string, "identity", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", "zero". Can be specified as a list matrix for general specification of both fixed and shared elements within the matrix.  May also be specified as a numeric matrix to use custom fixed values. Must have n rows (\(\mathbf{D}\)) or m rows (\(\mathbf{C}\)).</p></li>
<li><p><code>d</code> and <code>c</code> Default="zero".  Numeric matrix.  No missing values allowed.  Must have 1 column or the same number of columns as the data, \(\mathbf{y}\).  The numbers of rows in \(\mathbf{d}\) must be the same as number of columns in \(\mathbf{D}\); similarly for \(\mathbf{c}\) and \(\mathbf{C}\).</p></li>
<li><p><code>G</code> and <code>H</code> Default="identity".  A text string, "identity". Can be specified as a numeric matrix or array for time-varying cases. Must have m rows and g columns (\(\mathbf{G}\)) or n rows and h columns (\(\mathbf{H}\)). g is the dim of \(\mathbf{Q}\) and h is the dim of \(\mathbf{R}\).</p></li>
<li><p><code>tinitx</code> Default=0.  Whether the initial state is specified at t=0 (default) or t=1.</p></li>
</ul><p>All parameters except \(\mathbf{x}_0\) and \(\mathbf{V}_0\) may be time-varying.  If time-varying, then text shortcuts cannot be used.  Enter as an array with the 3rd dimension being time.   Time dimension must be 1 or equal to the number of time-steps in the data.    See Quick Start guide (<code>RShowDoc("Quick_Start",package="MARSS")</code>) or the User Guide (<code>RShowDoc("UserGuide",package="MARSS")</code>) for  examples.Valid model structures for <code>method="BFGS"</code> are the same as for <code>method="kem"</code>.  See  <code><a href="MARSSoptim.html">MARSSoptim</a>()</code> for the allowed options for this method.</p>
<p>The default estimation method, <code>method="kem"</code>, is the EM algorithm described in the MARSS User Guide.  The default settings for the control and inits arguments are set via <code>MARSS:::alldefaults$kem</code> in <code>MARSSsettings.R</code>.  The defaults for the model argument are set in <code>MARSS_marxss.R</code> For this method, they are:</p><ul><li><p>inits = list(B=1, U=0, Q=0.05, Z=1, A=0, R=0.05, x0=-99, V0=0.05, G=0, H=0, L=0, C=0, D=0, c=0, d=0)</p></li>
<li><p>model = list(Z="identity", A="scaling", R="diagonal and equal", B="identity", U="unconstrained", Q="diagonal and unequal", x0="unconstrained", V0="zero", C="zero",D="zero",c=matrix(0,0,1), d=matrix(0,0,1), tinitx=0, diffuse=FALSE)</p></li>
<li><p>control=list(minit=15, maxit=500, abstol=0.001, trace=0, sparse=FALSE,
                   safe=FALSE, allow.degen=TRUE, min.degen.iter=50, degen.lim=1.0e-04, 
                   min.iter.conv.test=15, conv.test.deltaT=9, conv.test.slope.tol= 0.5,  demean.states=FALSE) You can read about these in <code><a href="MARSS.html">MARSS</a>()</code>.  If you want to speed up your fits, you can turn off most of the model checking using <code>trace=-1</code>.</p></li>
<li><p>fun.kf = "MARSSkfas"; This sets the Kalman filter function to use.  <code><a href="MARSSkf.html">MARSSkfas()</a></code> is generally more stable as it uses Durban &amp; Koopman's algorithm.  But it may dramatically slow down when the data set is large (more than 10 rows of data).  Try the classic Kalman filter algorithm to see if it runs faster by setting <code>fun.kf="MARSSkfss"</code>. You can read about the two algorithms in <code><a href="MARSSkf.html">MARSSkf</a></code>.</p></li>
</ul><p>For <code>method="BFGS"</code>, type  <code>MARSS:::alldefaults$BFGS</code> to see the defaults.</p>


    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A object of class <code><a href="marssMLE-class.html">marssMLE</a></code>.  See <code><a href="print_marssMLE.html">print.marssMLE</a></code> for a discussion of the various output available for <code><a href="marssMLE-class.html">marssMLE</a></code> objects (coefficients, residuals, Kalman filter and smoother output, imputed values for missing data, etc.).  See <code><a href="MARSSsimulate.html">MARSSsimulate</a></code> for simulating from <code><a href="marssMLE-class.html">marssMLE</a></code> objects. <code><a href="MARSSboot.html">MARSSboot</a></code> for bootstrapping, <code><a href="MARSSaic.html">MARSSaic</a></code> for calculation of various AIC related model selection metrics, and <code><a href="MARSSparamCIs.html">MARSSparamCIs</a></code> for calculation of confidence intervals and bias. See <code><a href="plot_marssMLE.html">plot.marssMLE</a></code> for some default plots of a model fit.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes, NOAA, Seattle, USA.</p>
<p></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="marssMODEL-class.html">marssMODEL</a></code>, <code><a href="MARSS_dfa.html">MARSS.dfa</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#See the MARSS man page for examples</span></span></span>
<span class="r-in"><span><span class="op">?</span><span class="va">MARSS</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#and the Quick Examples chapter in the User Guide</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/RShowDoc.html" class="external-link">RShowDoc</a></span><span class="op">(</span><span class="st">"UserGuide"</span>,package<span class="op">=</span><span class="st">"MARSS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

