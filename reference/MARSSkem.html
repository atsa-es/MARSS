<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="MARSSkem() performs maximum-likelihood estimation, using an EM algorithm for constrained and unconstrained MARSS models.  Users would not call this function directly normally.  The function MARSS() calls MARSSkem().  However users might want to use MARSSkem() directly if they need to avoid some of the error-checking overhead associated with the MARSS() function."><title>EM Algorithm function for MARSS models — MARSSkem • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="EM Algorithm function for MARSS models — MARSSkem"><meta property="og:description" content="MARSSkem() performs maximum-likelihood estimation, using an EM algorithm for constrained and unconstrained MARSS models.  Users would not call this function directly normally.  The function MARSS() calls MARSSkem().  However users might want to use MARSSkem() directly if they need to avoid some of the error-checking overhead associated with the MARSS() function."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>EM Algorithm function for MARSS models</h1>
      
      <div class="d-none name"><code>MARSSkem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MARSSkem()</code> performs maximum-likelihood estimation, using an EM algorithm for constrained and unconstrained MARSS models.  Users would not call this function directly normally.  The function <code><a href="MARSS.html">MARSS</a>()</code> calls <code>MARSSkem()</code>.  However users might want to use <code>MARSSkem()</code> directly if they need to avoid some of the error-checking overhead associated with the <code><a href="MARSS.html">MARSS</a>()</code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MARSSkem</span><span class="op">(</span><span class="va">MLEobj</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>MLEobj</dt>
<dd><p>An object of class <code><a href="marssMLE-class.html">marssMLE</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Objects of class <code><a href="marssMLE-class.html">marssMLE</a></code> may be built from scratch but are easier to construct using <code><a href="MARSS.html">MARSS</a>()</code> with <code>MARSS(..., fit=FALSE)</code>.</p>
<p>Options for <code>MARSSkem()</code> may be set using <code>MLEobj$control</code>.  The commonly used elements of <code>control</code> are as follows (see <code><a href="marssMLE-class.html">marssMLE</a></code>):</p><dl><dt><code>minit</code></dt>
<dd><p>Minimum number of EM iterations. You can use this to force the algorithm to do a certain number of iterations.  This is helpful if your solution is not converging.</p></dd>
 
      <dt><code>maxit</code></dt>
<dd><p>Maximum number of EM iterations.</p></dd>
 
      <dt><code>min.iter.conv.test</code></dt>
<dd><p>The minimum number of iterations before the log-log convergence test will be computed.  If <code>maxit</code> is set less than this, then convergence will not be computed (and the algorithm will just run for maxit iterations).</p></dd>
 
      <dt><code>kf.x0</code></dt>
<dd><p>Whether to set the prior at \(t=0\) (<code>"x00"</code>) or at \(t=1\) (<code>"x10"</code>). The default is <code>"x00"</code>.</p></dd>
 
      <dt><code>conv.test.deltaT</code></dt>
<dd><p>The number of iterations to use in the log-log convergence test.  This defaults to 9.</p></dd>
 
      <dt><code>abstol</code></dt>
<dd><p>Tolerance for log-likelihood change for the delta logLik convergence test.  If log-likelihood changes less than this amount relative to the previous iteration, the EM algorithm exits. This is normally (default) set to NULL and the log-log convergence test is used instead.</p></dd>
 
      <dt><code>allow.degen</code></dt>
<dd><p>Whether to try setting \(\mathbf{Q}\) or \(\mathbf{R}\) elements to zero if they appear to be going to zero.</p></dd>

      <dt><code>trace</code></dt>
<dd><p>A positive integer. If not 0, a record will be created of each variable over all EM iterations and detailed warning messages (if appropriate) will be printed.</p></dd>

      <dt><code>safe</code></dt>
<dd><p>If TRUE, <code>MARSSkem</code> will rerun <code><a href="MARSSkf.html">MARSSkf</a></code> after each individual parameter update rather than only after all parameters are updated.  The latter is slower and unnecessary for many models, but in some cases, the safer and slower algorithm is needed because the ML parameter matrices have high condition numbers.</p></dd>

      <dt><code>silent</code></dt>
<dd><p>Suppresses printing of progress bars, error messages, warnings and convergence information.</p></dd>
    
    
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code><a href="marssMLE-class.html">marssMLE</a></code> object which was passed in, with additional components:</p>
<dl><dt>method</dt>
<dd><p>String "kem".</p></dd>

  <dt>kf</dt>
<dd><p>Kalman filter output.</p></dd>

  <dt>iter.record</dt>
<dd><p>If <code>MLEobj$control$trace = TRUE</code>, a list with <code>par</code> = a record of each estimated parameter over all EM iterations and <code>logLik</code> = a record of the log likelihood at each iteration.</p></dd>

  <dt>numIter</dt>
<dd><p>Number of iterations needed for convergence.</p></dd>

  <dt>convergence</dt>
<dd><p>Did estimation converge successfully?</p><dl><dt>convergence=0</dt>
<dd><p>Converged in both the abstol test and the log-log plot test.</p></dd>
  
      <dt>convergence=1</dt>
<dd><p>Some of the parameter estimates did not converge (based on the log-log plot test AND abstol tests) before <code>MLEobj$control$maxit</code> was reached. This is not an error per se.</p></dd>

      <dt>convergence=3</dt>
<dd><p>No convergence diagnostics were computed because all parameters were fixed thus no fitting required.</p></dd>
   
      <dt>convergence=-1</dt>
<dd><p>No convergence diagnostics were computed because the MLE object was not fit (called with fit=FALSE). This isn't a convergence error just information. There is not par element so no functions can be run with the object.</p></dd>
  
      <dt>convergence=2</dt>
<dd><p>No convergence diagnostics were computed because the MLE object had problems and was not fit. This isn't a convergence error just information.</p></dd>

      <dt>convergence=10</dt>
<dd><p>Abstol convergence only. Some of the parameter estimates did not converge (based on the log-log plot test) before <code>MLEobj$control$maxit</code> was reached.  However <code>MLEobj$control$abstol</code> was reached.</p></dd>

      <dt>convergence=11</dt>
<dd><p>Log-log convergence only. Some of the parameter estimates did not converge (based on the abstol test) before <code>MLEobj$control$maxit</code> was reached.  However the log-log convergence test was passed.</p></dd>

      <dt>convergence=12</dt>
<dd><p>Abstol convergence only. Log-log convergence test was not computed because <code>MLEobj$control$maxit</code> was set to less than <code>control$min.iter.conv.test</code>.</p></dd>
  
      <dt>convergence=13</dt>
<dd><p>Lack of convergence info. Parameter estimates did not converge based on the abstol test before <code>MLEobj$control$maxit</code> was reached.  No log-log information since <code>control$min.iter.conv.test</code> is less than <code>MLEobj$control$maxit</code> so no log-log plot test could be done.</p></dd>

      <dt>convergence=42</dt>
<dd><p><code>MLEobj$control$abstol</code> was reached but the log-log plot test returned NAs.  This is an odd error and you should set <code>control$trace=TRUE</code> and look at the outputted <code>$iter.record</code> to see what is wrong.</p></dd>

      <dt>convergence=52</dt>
<dd><p>The EM algorithm was abandoned due to numerical errors.  Usually this means one of the variances either went to zero or to all elements being equal.  This is not an error per se.  Most likely it means that your model is not very good for your data (too inflexible or too many parameters).  Try setting <code>control$trace=1</code> to view a detailed error report.</p></dd>

      <dt>convergence=53</dt>
<dd><p>The algorithm was abandoned due to numerical errors in the likelihood calculation from <code><a href="MARSSkf.html">MARSSkf</a></code>.</p></dd>
 
      <dt>convergence=62</dt>
<dd><p>The algorithm was abandoned due to errors in the log-log convergence test.  You should not get this error (it is included for debugging purposes to catch improper arguments passed into the log-log convergence test).</p></dd>

      <dt>convergence=63</dt>
<dd><p>The algorithm was run for <code>control$maxit</code> iterations, <code>control$abstol</code> not reached, and the log-log convergence test returned errors.  You should not get this error (it is included for debugging purposes to catch improper arguments passed into the log-log convergence test).</p></dd>

      <dt>convergence=72</dt>
<dd><p>Other convergence errors.  This is included for debugging purposes to catch misc. errors.</p></dd>
        
      
</dl><p></p></dd>

  <dt>logLik</dt>
<dd><p>Log-likelihood.</p></dd>

  <dt>states</dt>
<dd><p>State estimates from the Kalman smoother.</p></dd>

  <dt>states.se</dt>
<dd><p>Confidence intervals based on state standard errors, see caption of Fig 6.3 (p. 337) in Shumway &amp; Stoffer (2006).</p></dd>

  <dt>errors</dt>
<dd><p>Any error messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a></h2>
    <p>To ensure that the global maximum-likelihood values are found, it is recommended that you test the fit under different initial parameter values, particularly if the model is not a good fit to the data.  This requires more computation time, but reduces the chance of the algorithm terminating at a local maximum and not reaching the true MLEs.   For many models and for draft analyses, this is unnecessary, but answers should be checked using an initial conditions search before reporting final values.  See the chapter on initial conditions in the User Guide for a discussion on how to do this.</p>
<p><code>MARSSkem()</code> calls a Kalman filter/smoother <code><a href="MARSSkf.html">MARSSkf</a>()</code> for hidden state estimation.   The algorithm allows two options for the initial state conditions: fixed but unknown or a prior.  In the first case, x0 (whether at t=0 or t=1) is treated as fixed but unknown (estimated); in this case, <code>fixed$V0=0</code> and x0 is estimated.  This is the default behavior.  In the second case, the initial conditions are specified with a prior and V0!=0.   In the later case, x0 or V0 may be estimated.  MARSS will allow you to try to estimate both, but many researchers have noted that this is not robust so you should fix one or the other.</p> 
<p>If you get errors, you can type <code><a href="MARSSinfo.html">MARSSinfo</a>()</code> for help. Fitting problems often mean that the solution involves an ill-conditioned matrix.    For example, your \(\mathbf{Q}\) or \(\mathbf{R}\) matrix is going to a value in which all elements have the same value, for example zero.  If for example, you tried to fit a model with a fixed \(\mathbf{R}\) matrix with high values on the diagonal and the variance in that \(\mathbf{R}\) matrix (diagonal terms) was much higher than what is actually in the data, then you might drive \(\mathbf{Q}\) to zero.   Also if you try to fit a structurally inadequate model, then it is not unusual that \(\mathbf{Q}\) will be driven to zero.  For example, if you fit a model with 1 hidden state trajectory to data that clearly have 2 quite different hidden state trajectories, you might have this problem.  Comparing the likelihood of this model to a model with more structural flexibility should reveal that the structurally inflexible model is inadequate (much lower likelihood).</p> 
<p>Convergence testing is done via a combination of two tests.  The first test (abstol test) is the test that the change in the absolute value of the log-likelihood from one iteration to another is less than some tolerance value (abstol).  The second test (log-log test) is that the slope of a plot of the log of the parameter value or log-likelihood versus the log of the iteration number is less than some tolerance.  Both of these must be met to generate the Success! parameters converged output.  If you want to circumvent one of these tests, then set the tolerance for the unwanted test to be high.  That will guarantee that that test is met before the convergence test you want to use is met.  The tolerance for the abstol test is set by <code>control$abstol</code> and the tolerance for the log-log test is set by <code>control$conv.test.slope.tol</code>.  Anything over 1 is huge for both of these.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. H. Shumway and D. S. Stoffer (2006).  Chapter 6 in Time series analysis and its applications.  Springer-Verlag, New York.</p>  
<p>Ghahramani, Z. and Hinton, G. E. (1996) Parameter estimation for linear dynamical systems. Technical Report CRG-TR-96-2, University of Toronto, Dept. of Computer Science.</p>
<p>Harvey, A. C. (1989) Chapter 5 in Forecasting, structural time series models and the
Kalman filter. Cambridge University Press, Cambridge, UK.</p>  
<p>The MARSS User Guide:  Holmes, E. E., E. J. Ward, and M. D. Scheuerell (2012) Analysis of multivariate time-series using the MARSS package. NOAA Fisheries, Northwest Fisheries Science
Center, 2725 Montlake Blvd E., Seattle, WA 98112   Go to <a href="https://cran.r-project.org/package=MARSS/vignettes/UserGuide.pdf" class="external-link">User Guide</a> to open the most recent version.</p>
<p>Holmes, E. E. (2012).  Derivation of the EM algorithm for constrained and unconstrained multivariate autoregressive
state-space (MARSS) models.  Technical Report. arXiv:1302.3919 [stat.ME] <a href="https://cran.r-project.org/package=MARSS/vignettes/EMDerivation.pdf" class="external-link">EMDerivation</a> has the most recent version.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes and Eric Ward, NOAA, Seattle, USA.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MARSSkf.html">MARSSkf</a>()</code>, <code><a href="marssMLE-class.html">marssMLE</a></code>, <code><a href="MARSSoptim.html">MARSSoptim</a>()</code>, <code><a href="MARSSinfo.html">MARSSinfo</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">harborSeal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># you can use MARSS to construct a proper marssMLE object.</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">dat</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="st">"diagonal and equal"</span>, U <span class="op">=</span> <span class="st">"equal"</span><span class="op">)</span>, fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model form is marxss. Model Structure is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m: 3 state process(es) named X.CoastalEstuaries X.OlympicPeninsula X.StraitJuanDeFuca</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n: 3 observation time series named CoastalEstuaries OlympicPeninsula StraitJuanDeFuca</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z :  design matrix with rows: X.CoastalEstuaries X.OlympicPeninsula X.StraitJuanDeFuca (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A :  fixed and zero (3 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R :  diagonal and equal (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B :  identity (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U :  all equal (3 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q :  diagonal and equal (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0 :  unconstrained (3 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V0 :  fixed and zero (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D :  fixed and zero (3 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C :  fixed and zero (3 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d :  fixed and zero (1 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c :  fixed and zero (1 x 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G :  identity (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H :  identity (3 x 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L :  identity (3 x 3) </span>
<span class="r-in"><span><span class="co"># Pass this marssMLE object to MARSSkem to do the fit.</span></span></span>
<span class="r-in"><span><span class="va">kemfit</span> <span class="op">&lt;-</span> <span class="fu">MARSSkem</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Success! abstol and log-log tests passed at 59 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alert: conv.test.slope.tol is 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test with smaller values (&lt;0.1) to ensure convergence.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

