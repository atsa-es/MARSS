<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates the observed Fisher Information analytically via the recursion by Harvey (1989) as adapted by Holmes (2017) for MARSS models with linear constraints.  This is the same as the Hessian of the negative log-likelihood function at the MLEs.  This is a utility function in the MARSS-package and is not exported.  Use MARSShessian() to access."><title>Hessian Matrix via the Harvey (1989) Recursion — MARSSharveyobsFI • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Hessian Matrix via the Harvey (1989) Recursion — MARSSharveyobsFI"><meta property="og:description" content="Calculates the observed Fisher Information analytically via the recursion by Harvey (1989) as adapted by Holmes (2017) for MARSS models with linear constraints.  This is the same as the Hessian of the negative log-likelihood function at the MLEs.  This is a utility function in the MARSS-package and is not exported.  Use MARSShessian() to access."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hessian Matrix via the Harvey (1989) Recursion</h1>
      
      <div class="d-none name"><code>MARSSharveyobsFI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the observed Fisher Information analytically via the recursion by Harvey (1989) as adapted by Holmes (2017) for MARSS models with linear constraints.  This is the same as the Hessian of the negative log-likelihood function at the MLEs.  This is a utility function in the <code><a href="MARSS-package.html">MARSS-package</a></code> and is not exported.  Use <code><a href="MARSShessian.html">MARSShessian</a>()</code> to access.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MARSSharveyobsFI</span><span class="op">(</span><span class="va">MLEobj</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>MLEobj</dt>
<dd><p>An object of class <code><a href="marssMLE-class.html">marssMLE</a></code>. 
  This object must have a <code>$par</code> element containing MLE parameter estimates from e.g. <code><a href="MARSSkem.html">MARSSkem</a></code>.</p></dd>

 </dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The observed Fisher Information matrix computed via equation 3.4.69 in Harvey (1989).  The differentials in the equation are computed in the recursion in equations 3.4.73a to 3.4.74b.  See Holmes (2016c) for a discussion of the Harvey (1989) algorithm and Holmes (2017) for the specific implementation of the algorithm for MARSS models with linear constraints.</p>
  

<p>Harvey (1989) discusses missing observations in section 3.4.7.  However, the <code>MARSSharveyobsFI()</code> function implements the approach of Shumway and Stoffer (2006) in section 6.4 for the missing values.  See Holmes (2012) for a full discussion of the missing values modifications.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes, NOAA, Seattle, USA.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MARSShessian.html">MARSShessian</a>()</code>, <code><a href="MARSSparamCIs.html">MARSSparamCIs</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. H. Shumway and D. S. Stoffer (2006).  Section 6.4 (Missing Data Modifications) in Time series analysis and its applications.  Springer-Verlag, New York.</p>  
<p>Harvey, A. C. (1989) Section 3.4.5 (Information matrix) in Forecasting, structural time series models and the Kalman filter. Cambridge University Press, Cambridge, UK.</p>  
<p>See also J. E. Cavanaugh and R. H. Shumway (1996) On computing the expected Fisher information matrix for state-space model parameters. Statistics &amp; Probability Letters 26: 347-355.  This paper discusses the Harvey (1989) recursion (and proposes an alternative).</p>
<p>Holmes, E. E. (2012).  Derivation of the EM algorithm for constrained and unconstrained multivariate autoregressive state-space (MARSS) models.  Technical Report. arXiv:1302.3919 [stat.ME]</p>
<p>Holmes, E. E. 2016c. Notes on computing the Fisher Information matrix for MARSS models. Part III Overview of Harvey 1989. https://eeholmes.github.io/posts/2016-6-16-FI-recursion-3/</p>
<p>Holmes, E. E. 2017. Notes on computing the Fisher Information matrix for MARSS models. Part IV Implementing the Recursion in Harvey 1989. https://eeholmes.github.io/posts/2017-5-31-FI-recursion-4/</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">harborSeal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Success! abstol and log-log tests passed at 26 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alert: conv.test.slope.tol is 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test with smaller values (&lt;0.1) to ensure convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MARSS fit is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: kem </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence test: conv.test.slope.tol = 0.5, abstol = 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation converged in 26 iterations. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 11.74016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -9.480311   AICc: -6.3692   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                      0.0115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                        0.0613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                           0.0510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)   0.0147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)         0.0122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                       7.3823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                          6.2707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial states (x0) defined at t=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors have not been calculated. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use MARSSparamCIs to compute CIs and bias estimates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">MARSS</span><span class="fu">:::</span><span class="fu">MARSSharveyobsFI</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                  R.diag U.X.CoastalEstuaries</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                    52914.2357125           -154.19136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                       -154.1913603           1662.00142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                           169.2513722              0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries) 12164.4113628            120.60426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)       13737.8120129              0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                         1.9507559             68.10553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                           -0.7477657              0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           U.X.OR.NorthCoast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                             169.2514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                                 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                                 2332.1767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)            0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)               -159.5791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                                0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                                  82.0963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           Q.(X.CoastalEstuaries,X.CoastalEstuaries)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                                                 12164.411363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                                                     120.604263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                                                          0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)                              16821.992564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)                                        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                                                     -1.525828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                                                         0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           Q.(X.OR.NorthCoast,X.OR.NorthCoast)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                                          13737.8120129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                                                0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                                                -159.5790963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)                           0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)                             23236.9701088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                                               0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                                                  0.7050328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           x0.X.CoastalEstuaries</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                                 1.950756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                                  68.105533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                                      0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)             -1.525828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)                    0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                                 44.922134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                                     0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           x0.X.OR.NorthCoast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                            -0.7477657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                               0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                                 82.0962990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)          0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)                0.7050328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                                21.5655793</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

