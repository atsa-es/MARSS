<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates bootstrap parameter estimates and simulated (or bootstrapped) data (if appropriate).  This is a base function in the MARSS-package."><title>Bootstrap MARSS Parameter Estimates — MARSSboot • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Bootstrap MARSS Parameter Estimates — MARSSboot"><meta property="og:description" content="Creates bootstrap parameter estimates and simulated (or bootstrapped) data (if appropriate).  This is a base function in the MARSS-package."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap MARSS Parameter Estimates</h1>
      
      <div class="d-none name"><code>MARSSboot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates bootstrap parameter estimates and simulated (or bootstrapped) data (if appropriate).  This is a base function in the <code><a href="MARSS-package.html">MARSS-package</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MARSSboot</span><span class="op">(</span><span class="va">MLEobj</span>, nboot <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>    output <span class="op">=</span> <span class="st">"parameters"</span>, sim <span class="op">=</span> <span class="st">"parametric"</span>, </span>
<span>    param.gen <span class="op">=</span> <span class="st">"MLE"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>MLEobj</dt>
<dd><p>An object of class <code><a href="marssMLE-class.html">marssMLE</a></code>. Must have a <code>$par</code> element containing MLE parameter estimates.</p></dd>

  <dt>nboot</dt>
<dd><p>Number of bootstraps to perform.</p></dd>

  <dt>output</dt>
<dd><p>Output to be returned: "data", "parameters" or "all".</p></dd>
 
  <dt>sim</dt>
<dd><p>Type of bootstrap: "parametric" or "innovations". See Details.</p></dd>

  <dt>param.gen</dt>
<dd><p>Parameter generation method: "hessian" or "MLE".</p></dd>
 
  <dt>control</dt>
<dd><p>The options in <code>MLEobj$control</code> are used by default. If supplied here, must contain all of the following:</p><dl><dt><code>max.iter</code></dt>
<dd><p>Maximum number of EM iterations.</p></dd>
 
      <dt><code>tol</code></dt>
<dd><p>Optional tolerance for log-likelihood change.  If log-likelihood decreases less than this amount relative to the previous iteration, the EM algorithm exits.</p></dd>
 
      <dt><code>allow.degen</code></dt>
<dd><p>Whether to try setting \(\mathbf{Q}\) or \(\mathbf{R}\) elements to zero if they appear to be going to zero.</p></dd>
  
    
</dl><p></p></dd>

  <dt>silent</dt>
<dd><p>Suppresses printing of progress bar.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Approximate confidence intervals (CIs) on the model parameters can be calculated by the observed Fisher Information matrix (the Hessian of the negative log-likelihood function).  The Hessian CIs (<code>param.gen="hessian"</code>) are based on the asymptotic normality of ML estimates under a large-sample approximation. CIs that are not based on asymptotic theory can be calculated using parametric and non-parametric bootstrapping (<code>param.gen="MLE"</code>).  In this case, parameter estimates are generated by the ML estimates from each bootstrapped data set.  The MLE method (kem or BFGS) is determined by <code>MLEobj$method</code>.</p>
<p>Stoffer and Wall (1991) present an algorithm for generating CIs via a non-parametric bootstrap for state-space models (<code>sim = "innovations"</code>).  The basic idea is that the Kalman filter can be used to generate estimates of the residuals of the model fit.  These residuals are then standardized and resampled and used to generate bootstrapped data using the MARSS model and its maximum-likelihood parameter estimates.  One of the limitations of the Stoffer and Wall algorithm is that it cannot be used when there are missing data, unless all data at time \(t\) are missing.  An alternative approach is a parametric bootstrap (<code>sim = "parametric"</code>), in which the ML parameter estimates are used to produce bootstrapped data directly from the state-space model.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with the following components:</p>
<dl><dt>boot.params</dt>
<dd><p>Matrix (number of params x nboot) of parameter estimates from the bootstrap.</p></dd>

  <dt>boot.data</dt>
<dd><p>Array (n x t x nboot) of simulated (or bootstrapped) data (if requested and appropriate).</p></dd>

  <dt>marss</dt>
<dd><p>The <code><a href="marssMODEL-class.html">marssMODEL</a></code> object (form="marss") that was passed in via <code>MLEobj$marss</code>.</p></dd>

  <dt>nboot</dt>
<dd><p>Number of bootstraps performed.</p></dd>

  <dt>output</dt>
<dd><p>Type of output returned.</p></dd>
 
  <dt>sim</dt>
<dd><p>Type of bootstrap.</p></dd>

  <dt>param.gen</dt>
<dd><p>Parameter generation method: "hessian" or "KalmanEM".</p></dd>
 
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Holmes, E. E., E. J. Ward, and M. D. Scheuerell (2012) Analysis of multivariate time-series using the MARSS package. NOAA Fisheries, Northwest Fisheries Science
Center, 2725 Montlake Blvd E., Seattle, WA 98112   Type <code>RShowDoc("UserGuide",package="MARSS")</code> to open a copy.</p>
<p>Stoffer, D. S., and K. D. Wall. 1991. Bootstrapping state-space models: Gaussian maximum likelihood estimation and the Kalman filter. Journal of the American Statistical Association 86:1024-1033.</p>
<p>Cavanaugh, J. E., and R. H. Shumway. 1997. A bootstrap variant of AIC for state-space model selection. Statistica Sinica 7:473-496.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes and Eric Ward, NOAA, Seattle, USA.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="marssMLE-class.html">marssMLE</a></code>,  <code><a href="marssMODEL-class.html">marssMODEL</a></code>,  <code><a href="MARSSaic.html">MARSSaic</a>()</code>, <code><a href="MARSShessian.html">MARSShessian</a>()</code>, <code><a href="MARSSFisherI.html">MARSSFisherI</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># nboot is set low in these examples in order to run quickly</span></span></span>
<span class="r-in"><span><span class="co"># normally nboot would be &gt;1000 at least</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">kestrel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># maxit set low to speed up the example</span></span></span>
<span class="r-in"><span><span class="va">kem</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>U <span class="op">=</span> <span class="st">"equal"</span>, Q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Success! algorithm run for 15 iterations. abstol and log-log tests passed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alert: conv.test.slope.tol is 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test with smaller values (&lt;0.1) to ensure convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MARSS fit is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: kem </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence test: conv.test.slope.tol = 0.5, abstol = 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm ran 15 (=minit) iterations and convergence was reached. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -11.12704 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 30.25409   AICc: 30.78742   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                 0.04958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.1                   -0.00783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.British.Columbia  0.78786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.Alberta           0.73740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial states (x0) defined at t=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors have not been calculated. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use MARSSparamCIs to compute CIs and bias estimates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># bootstrap parameters from a Hessian matrix</span></span></span>
<span class="r-in"><span><span class="va">hess.list</span> <span class="op">&lt;-</span> <span class="fu">MARSSboot</span><span class="op">(</span><span class="va">kem</span>, param.gen <span class="op">=</span> <span class="st">"hessian"</span>, nboot <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MARSSboot: Computing the Hessian.  This might take awhile.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           |2%      |20%      |40%      |60%      |80%      |100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress: ||||||||||||||||||||||||||||||||||||||||||||||||||</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># from resampling the innovations (no missing values allowed)</span></span></span>
<span class="r-in"><span><span class="va">boot.innov.list</span> <span class="op">&lt;-</span> <span class="fu">MARSSboot</span><span class="op">(</span><span class="va">kem</span>, output <span class="op">=</span> <span class="st">"all"</span>, sim <span class="op">=</span> <span class="st">"innovations"</span>, nboot <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           |2%      |20%      |40%      |60%      |80%      |100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress: ||||||||||||||||||||||||||||||||||||||||||||||||||</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># bootstrapped parameter estimates</span></span></span>
<span class="r-in"><span><span class="va">hess.list</span><span class="op">$</span><span class="va">boot.params</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              [,1]         [,2]         [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                 0.04015958  0.055319732  0.048188019 0.026875603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.1                   -0.02639235 -0.005100932 -0.003792567 0.006973745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.British.Columbia  1.11099485  0.861835256  0.656915029 1.063038005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.Alberta           0.61250010  0.612674666  1.182270491 0.825369394</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

