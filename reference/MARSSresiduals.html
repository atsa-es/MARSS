<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The normal residuals function is residuals(). MARSSresiduals() returns residuals as a list of matrices while residuals() returns the same information in a data frame.  This function calculates the residuals, residuals variance, and standardized residuals for the one-step-ahead (conditioned on data up to \(t-1\)), the smoothed (conditioned on all the data), and contemporaneous (conditioned on data up to \(t\)) residuals."><title>MARSS Residuals — MARSSresiduals • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="MARSS Residuals — MARSSresiduals"><meta property="og:description" content="The normal residuals function is residuals(). MARSSresiduals() returns residuals as a list of matrices while residuals() returns the same information in a data frame.  This function calculates the residuals, residuals variance, and standardized residuals for the one-step-ahead (conditioned on data up to \(t-1\)), the smoothed (conditioned on all the data), and contemporaneous (conditioned on data up to \(t\)) residuals."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MARSS Residuals</h1>
      
      <div class="d-none name"><code>MARSSresiduals.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The normal residuals function is <code><a href="residuals_marssMLE.html">residuals</a>()</code>. <code>MARSSresiduals()</code> returns residuals as a list of matrices while <code><a href="residuals_marssMLE.html">residuals</a>()</code> returns the same information in a data frame.  This function calculates the residuals, residuals variance, and standardized residuals for the one-step-ahead (conditioned on data up to \(t-1\)), the smoothed (conditioned on all the data), and contemporaneous (conditioned on data up to \(t\)) residuals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MARSSresiduals</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tT"</span>, <span class="st">"tt1"</span>, <span class="st">"tt"</span><span class="op">)</span>, </span>
<span>    normalize <span class="op">=</span> <span class="cn">FALSE</span>, silent <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    fun.kf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MARSSkfas"</span>, <span class="st">"MARSSkfss"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>marssMLE</code>.</p></dd>

  <dt>...</dt>
<dd><p>Additional arguments to be passed to the residuals functions. For type="tT", <code>Harvey=TRUE</code> can be passed into to use the Harvey et al (1998) algorithm.</p></dd>

  <dt>type</dt>
<dd><p><code>"tT"</code> for smoothed residuals conditioned on all the data \(t=1\) to \(T\), aka smoothation residuals. <code>"tt1"</code> for one-step-ahead residuals, aka innovations residuals. <code>"tt"</code> for contemporaneous residuals.</p></dd>

  <dt>normalize</dt>
<dd><p>TRUE/FALSE See details.</p></dd>

  <dt>silent</dt>
<dd><p>If TRUE, do not print inversion warnings.</p></dd>

  <dt>fun.kf</dt>
<dd><p>Kalman filter function to use. Can be ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of the following components</p>
<dl><dt>model.residuals</dt>
<dd><p>The model residuals (data minus model predicted values) as a n x T matrix.</p></dd>

  <dt>state.residuals</dt>
<dd><p>The  state residuals. This is the state residual for the transition from \(t=t\) to \(t+1\) thus the last time step will be NA (since \(T+1\) is past the data). State residuals do not exist for the <code>type="tt"</code> case (since this would required the expected value of \(\mathbf{X}_t\) conditioned on data to \(t+1\)).</p></dd>

  <dt>residuals</dt>
<dd><p>The residuals as a (n+m) x T matrix with <code>model.residuals</code> on top and <code>state.residuals</code> below.</p></dd>

  <dt>var.residuals</dt>
<dd><p>The variance of the model residuals and state residuals as a (n+m) x (n+m) x T matrix with the model residuals variance in rows/columns 1 to n and state residuals variances in rows/columns n+1 to n+m. The last time step will be all NA since the state residual is for \(t=t \) to \(t+1\).</p></dd>

  <dt>std.residuals</dt>
<dd><p>The Cholesky standardized residuals as a (n+m) x T matrix. This is <code>residuals</code> multiplied by the inverse of the lower triangle of the Cholesky decomposition of <code>var.residuals</code>.</p></dd>

  <dt>mar.residuals</dt>
<dd><p>The marginal standardized residuals as a (n+m) x T matrix. This is <code>residuals</code> multiplied by the inverse of the diagonal matrix formed by the square-root of the diagonal of <code>var.residuals</code>.</p></dd>

  <dt>bchol.residuals</dt>
<dd><p>The Block Cholesky standardized residuals as a (n+m) x T matrix. This is <code>model.residuals</code> multiplied by the inverse of the lower triangle of the Cholesky decomposition of <code>var.residuals[1:n,1:n,]</code> and <code>state.residuals</code> multiplied by the inverse of the lower triangle of the Cholesky decomposition of <code>var.residuals[(n+1):(n+m),(n+1):(n+m),]</code>.</p></dd>

    <dt>E.obs.residuals</dt>
<dd><p>The expected value of the model residuals conditioned on the observed data. Returned as a n x T matrix.  For observed data, this will be the observed model residuals. For unobserved data, this will be 0 if \(\mathbf{R}\) is diagonal but non-zero if \(\mathbf{R}\) is non-diagonal. See <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>.</p></dd>

    <dt>var.obs.residuals</dt>
<dd><p>The variance of the model residuals conditioned on the observed data. Returned as a n x n x T matrix.  For observed data, this will be 0. See <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>.</p></dd>

  <dt>msg</dt>
<dd><p>Any warning messages. This will be printed unless Object$control$trace = -1 (suppress all error messages).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>For smoothed residuals, see <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>.</p>
<p>For one-step-ahead residuals, see <code><a href="MARSSresiduals_tt1.html">MARSSresiduals.tt1</a>()</code>.</p>
<p>For contemporaneous residuals, see <code><a href="MARSSresiduals_ttt.html">MARSSresiduals.tt</a>()</code>.</p>
<p><strong>Standardized residuals</strong></p>
<p>Standardized residuals have been adjusted by the variance of the residuals at time \(t\) such that the variance of the residuals at time \(t\) equals 1. Given the normality assumption, this means that one typically sees +/- 2 confidence interval lines on standardized residuals plots.</p>
<p><code>std.residuals</code> are Cholesky standardized residuals. These are the residuals multiplied by the inverse of the lower triangle of the Cholesky decomposition of the variance matrix of the residuals: 
$$ \hat{\Sigma}_t^{-1/2} \hat{\mathbf{v}}_t.$$
These residuals are uncorrelated with each other, although they are not necessarily temporally uncorrelated (innovations residuals are temporally uncorrelated).</p>
<p>The interpretation of the Cholesky standardized residuals is not straight-forward when the \(\mathbf{Q}\) and \(\mathbf{R}\) variance-covariance matrices are non-diagonal.  The residuals which were generated by a non-diagonal variance-covariance matrices are transformed into orthogonal residuals in \(\textrm{MVN}(0,\mathbf{I})\) space.  For example, if v is 2x2 correlated errors with variance-covariance matrix \(\mathbf{R}\). The transformed residuals (from this function) for the i-th row of v is a combination of the row 1 effect and the row 1 effect plus the row 2 effect.  So in this case, row 2 of the transformed residuals would not be regarded as solely the row 2 residual but rather how different row 2 is from row 1, relative to expected.  If the errors are highly correlated, then the Cholesky standardized residuals can look rather non-intuitive.</p>
<p><code>mar.residuals</code> are the marginal standardized residuals. These are the residuals multiplied by the inverse of the diagonal matrix formed from the square-root of the diagonal of the variance matrix of the residuals: 
$$ \textrm{dg}(\hat{\Sigma}_t)^{-1/2} \hat{\mathbf{v}}_t,$$ where \(dg(A)\) is the square matrix formed from the diagonal of \(A\), aka <code>diag(diag(A))</code>. These residuals will be correlated if the variance matrix is non-diagonal.</p>
<p>The Block Cholesky standardized residuals are like the Cholesky standardized residuals except that the full variance-covariance matrix is not used, only the variance-covariance matrix for the model or state residuals (respectively) is used for standardization. For the model residuals, the Block Cholesky standardized residuals will be the same as the Cholesky standardized residuals because the upper triangle of the lower triangle of the Cholesky decomposition (which is what we standardize by) is all zero. For <code>type="tt1"</code> and <code>type="tt"</code>, the Block Cholesky standardized state residuals will be the same as the Cholesky standardized state residuals because in the former, the model and state residuals are uncorrelated and in the latter, the state residuals do not exist. For <code>type="tT"</code>, the model and state residuals are correlated and the Block Cholesky standardized residuals will be different than the Cholesky standardized residuals.</p>
<p><strong>Normalized residuals</strong></p>
<p>If <code>normalize=FALSE</code>, the unconditional variance of \(\mathbf{V}_t\) and \(\mathbf{W}_t\) are \(\mathbf{R}\) and \(\mathbf{Q}\) and the model is assumed to be written as
$$\mathbf{y}_t = \mathbf{Z} \mathbf{x}_t + \mathbf{a} + \mathbf{v}_t$$
$$\mathbf{x}_t = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{w}_t$$
If <code>normalize=TRUE</code>, the model is assumed to be written as
$$\mathbf{y}_t = \mathbf{Z} \mathbf{x}_t + \mathbf{a} + \mathbf{H}\mathbf{v}_t$$
$$\mathbf{x}_t = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{G}\mathbf{w}_t$$
with the variance of \(\mathbf{V}_t\) and \(\mathbf{W}_t\) equal to \(\mathbf{I}\) (identity).</p>
<p><strong>Missing or left-out data</strong></p>
<p>See the discussion of residuals for missing and left-out data in <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes, NOAA, Seattle, USA.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="residuals_marssMLE.html">residuals.marssMLE</a>()</code>, <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>, <code><a href="MARSSresiduals_tt1.html">MARSSresiduals.tt1</a>()</code>, <code><a href="plot_marssMLE.html">plot.marssMLE</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Holmes, E. E. 2014. Computation of standardized residuals for (MARSS) models. Technical Report. arXiv:1411.0045.</p>
<p>See also the discussion and references in <code><a href="MARSSresiduals_tT.html">MARSSresiduals.tT</a>()</code>,  <code><a href="MARSSresiduals_tt1.html">MARSSresiduals.tt1</a>()</code> and <code><a href="MARSSresiduals_ttt.html">MARSSresiduals.tt</a>()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">harborSeal</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">11</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Success! abstol and log-log tests passed at 26 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alert: conv.test.slope.tol is 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test with smaller values (&lt;0.1) to ensure convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MARSS fit is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: kem </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence test: conv.test.slope.tol = 0.5, abstol = 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation converged in 26 iterations. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 11.74016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -9.480311   AICc: -6.3692   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag                                      0.0115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.CoastalEstuaries                        0.0613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.X.OR.NorthCoast                           0.0510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.CoastalEstuaries,X.CoastalEstuaries)   0.0147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(X.OR.NorthCoast,X.OR.NorthCoast)         0.0122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.CoastalEstuaries                       7.3823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.X.OR.NorthCoast                          6.2707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial states (x0) defined at t=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors have not been calculated. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use MARSSparamCIs to compute CIs and bias estimates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#state smoothed residuals</span></span></span>
<span class="r-in"><span>  <span class="va">state.resids1</span> <span class="op">&lt;-</span> <span class="fu">MARSSresiduals</span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"tT"</span><span class="op">)</span><span class="op">$</span><span class="va">state.residuals</span></span></span>
<span class="r-in"><span>  <span class="co">#this is the same as</span></span></span>
<span class="r-in"><span>  <span class="va">states</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span></span></span>
<span class="r-in"><span>  <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"matrix"</span><span class="op">)</span><span class="op">$</span><span class="va">Q</span></span></span>
<span class="r-in"><span>  <span class="va">state.resids2</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">-</span><span class="va">states</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>,type<span class="op">=</span><span class="st">"matrix"</span><span class="op">)</span><span class="op">$</span><span class="va">U</span>,<span class="fl">2</span>,<span class="fl">29</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#compare the two</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">state.resids1</span><span class="op">[</span>,<span class="op">-</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">state.resids2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X.CoastalEstuaries X.OR.NorthCoast X.CoastalEstuaries X.OR.NorthCoast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]       1.127322e-02    1.305044e-03       1.127322e-02    1.305044e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]       7.963885e-02    1.305044e-03       7.963885e-02    1.305044e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]       1.003050e-01    5.894950e-03       1.003050e-01    5.894950e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]       5.842127e-02    5.894950e-03       5.842127e-02    5.894950e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]       5.842127e-02    5.894950e-03       5.842127e-02    5.894950e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]       1.843052e-01    5.894950e-03       1.843052e-01    5.894950e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]       7.296579e-02    5.894950e-03       7.296579e-02    5.894950e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]      -7.717274e-02    8.380770e-02      -7.717274e-02    8.380770e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]      -3.934571e-02    2.025237e-02      -3.934571e-02    2.025237e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]       8.981293e-02    2.169964e-02       8.981293e-02    2.169964e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]      -4.456791e-02   -5.700953e-03      -4.456791e-02   -5.700953e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]       1.276304e-01    1.399795e-01       1.276304e-01    1.399795e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]      -4.420982e-02    7.507078e-02      -4.420982e-02    7.507078e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]      -5.118714e-02    7.306581e-02      -5.118714e-02    7.306581e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]       1.668539e-02   -7.661036e-03       1.668539e-02   -7.661036e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]       1.668539e-02   -2.730277e-02       1.668539e-02   -2.730277e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]      -9.075282e-02    1.000082e-01      -9.075282e-02    1.000082e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]      -9.256248e-02   -3.706648e-02      -9.256248e-02   -3.706648e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]      -1.985319e-01   -8.425263e-02      -1.985319e-01   -8.425263e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]      -4.018557e-02   -9.856455e-02      -4.018557e-02   -9.856455e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]      -1.976336e-03   -1.899573e-02      -1.976336e-03   -1.899573e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]      -1.860011e-02   -3.712384e-02      -1.860011e-02   -3.712384e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]      -5.850906e-02   -3.712384e-02      -5.850906e-02   -3.712384e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]      -5.850906e-02   -1.868614e-01      -5.850906e-02   -1.868614e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]       1.179612e-16   -1.149331e-01       1.179612e-16   -1.149331e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]       1.179612e-16   -2.651891e-02       1.179612e-16   -2.651891e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]       1.179612e-16    8.270704e-02       1.179612e-16    8.270704e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]       1.179612e-16    5.182492e-02       1.179612e-16    5.182492e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]       1.179612e-16    1.110223e-16       1.179612e-16    1.110223e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#normalize to variance of 1</span></span></span>
<span class="r-in"><span>  <span class="va">state.resids1</span> <span class="op">&lt;-</span> <span class="fu">MARSSresiduals</span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"tT"</span>, normalize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">state.residuals</span></span></span>
<span class="r-in"><span>  <span class="va">state.resids2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">state.resids2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">state.resids1</span><span class="op">[</span>,<span class="op">-</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">state.resids2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X.CoastalEstuaries X.OR.NorthCoast X.CoastalEstuaries X.OR.NorthCoast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]       9.303347e-02    1.182461e-02       9.303347e-02    1.182461e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]       6.572282e-01    1.182461e-02       6.572282e-01    1.182461e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]       8.277781e-01    5.341238e-02       8.277781e-01    5.341238e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]       4.821278e-01    5.341238e-02       4.821278e-01    5.341238e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]       4.821278e-01    5.341238e-02       4.821278e-01    5.341238e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]       1.520998e+00    5.341238e-02       1.520998e+00    5.341238e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]       6.021581e-01    5.341238e-02       6.021581e-01    5.341238e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]      -6.368764e-01    7.593565e-01      -6.368764e-01    7.593565e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]      -3.247047e-01    1.835007e-01      -3.247047e-01    1.835007e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]       7.411909e-01    1.966139e-01       7.411909e-01    1.966139e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]      -3.678015e-01   -5.165463e-02      -3.678015e-01   -5.165463e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]       1.053284e+00    1.268313e+00       1.053284e+00    1.268313e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]      -3.648463e-01    6.801938e-01      -3.648463e-01    6.801938e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]      -4.224274e-01    6.620275e-01      -4.224274e-01    6.620275e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]       1.376980e-01   -6.941435e-02       1.376980e-01   -6.941435e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]       1.376980e-01   -2.473822e-01       1.376980e-01   -2.473822e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]      -7.489474e-01    9.061444e-01      -7.489474e-01    9.061444e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]      -7.638818e-01   -3.358483e-01      -7.638818e-01   -3.358483e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]      -1.638406e+00   -7.633879e-01      -1.638406e+00   -7.633879e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]      -3.316358e-01   -8.930639e-01      -3.316358e-01   -8.930639e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]      -1.630993e-02   -1.721146e-01      -1.630993e-02   -1.721146e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]      -1.534994e-01   -3.363680e-01      -1.534994e-01   -3.363680e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]      -4.828523e-01   -3.363680e-01      -4.828523e-01   -3.363680e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]      -4.828523e-01   -1.693095e+00      -4.828523e-01   -1.693095e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]       9.734875e-16   -1.041374e+00       9.734875e-16   -1.041374e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]       9.734875e-16   -2.402799e-01       9.734875e-16   -2.402799e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]       9.734875e-16    7.493838e-01       9.734875e-16    7.493838e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]       9.734875e-16    4.695701e-01       9.734875e-16    4.695701e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]       9.734875e-16    1.005940e-15       9.734875e-16    1.005940e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#one-step-ahead standardized residuals</span></span></span>
<span class="r-in"><span>  <span class="fu">MARSSresiduals</span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"tt1"</span><span class="op">)</span><span class="op">$</span><span class="va">std.residuals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           [,1]         [,2]         [,3]     [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries   -0.05418676 -0.206286276  0.566365934 1.005768        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast               NA           NA -0.001882139       NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries -0.20628628  0.566365934  1.005767860 0.000000 0.2204673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast     0.00000000 -0.001882139  0.000000000 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         [,6]       [,7]       [,8]       [,9]      [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries   0.2204673  2.0405379  1.2425972 -0.7982010 -0.8746660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast             NA         NA -0.1395806  1.1554718  0.1779561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries 2.0405379  1.2425972 -0.7982010 -0.8746660  1.3133883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast    0.0000000 -0.1395806  1.1554718  0.1779561  0.3438440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         [,11]      [,12]      [,13]      [,14]       [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries    1.3133883 -1.1010233  1.7849809 -0.3351368 -0.71142906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast       0.3438440 -0.8332411  1.6166181  0.6909545  1.09517141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries -1.1010233  1.7849809 -0.3351368 -0.7114291  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast    -0.8332411  1.6166181  0.6909545  1.0951714  0.03597429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,16]      [,17]       [,18]       [,19]      [,20]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries            NA  0.5726369 -0.76775282 -0.31659312 -2.3132481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast       0.03597429 -0.9304752  1.64162505 -0.08266883 -0.6865966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries  0.57263695 -0.7677528 -0.31659312 -2.31324808 -0.4943444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast    -0.93047525  1.6416251 -0.08266883 -0.68659660 -1.3199941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,21]       [,22]      [,23]      [,24]      [,25]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries   -0.49434441  0.05447392 0.01643296         NA -0.8768965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast      -1.31999410 -0.07484734         NA  0.2166126 -2.1429904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries  0.05447392  0.01643296 0.00000000 -0.8768965  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast    -0.07484734  0.00000000 0.21661261 -2.1429904 -1.5204468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         [,26]      [,27]     [,28]     [,29] [,30]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CoastalEstuaries           NA         NA        NA        NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR.NorthCoast      -1.5204468 -0.8263151 0.9151561 0.7476442    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.CoastalEstuaries  0.0000000  0.0000000 0.0000000 0.0000000    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.OR.NorthCoast    -0.8263151  0.9151561 0.7476442 0.0000000    NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

