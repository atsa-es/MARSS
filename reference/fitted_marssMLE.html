<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

fitted() returns the different types of fitted values for \(\mathbf{x}_t\) and \(\mathbf{y}_t\) in a MARSS model. The fitted values are the expected value of the right side of the MARSS equations without the error terms, thus are the model predictions of \(\mathbf{y}_t\) or \(\mathbf{x}_t\). fitted.marssMLE is a companion function to tsSmooth() which returns the expected value of the right side of the MARSS equations with the error terms (the Kalman filter and smoother output).
$$\mathbf{x}_{t} = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{C} \mathbf{c}_t + \mathbf{G} \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q})$$
$$\mathbf{y}_t = \mathbf{Z} \mathbf{x}_t + \mathbf{a} + \mathbf{D} \mathbf{d}_t + \mathbf{H} \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R})$$
The data go from \(t=1\) to \(t=T\). For brevity, the parameter matrices are shown without a time subscript, however all parameters can be time-varying.
Note that the prediction of \(\mathbf{x}_t\) conditioned on the data up to time \(t\) is not provided since that would require the expected value of \(\mathbf{X}_{t}\) conditioned on data from \(t = 1\) to \(t+1\), which is not output from the Kalman filter or smoother."><title>Return fitted values for X(t) and Y(t) in a MARSS model — fitted.marssMLE • MARSS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Return fitted values for X(t) and Y(t) in a MARSS model — fitted.marssMLE"><meta property="og:description" content="

fitted() returns the different types of fitted values for \(\mathbf{x}_t\) and \(\mathbf{y}_t\) in a MARSS model. The fitted values are the expected value of the right side of the MARSS equations without the error terms, thus are the model predictions of \(\mathbf{y}_t\) or \(\mathbf{x}_t\). fitted.marssMLE is a companion function to tsSmooth() which returns the expected value of the right side of the MARSS equations with the error terms (the Kalman filter and smoother output).
$$\mathbf{x}_{t} = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{C} \mathbf{c}_t + \mathbf{G} \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q})$$
$$\mathbf{y}_t = \mathbf{Z} \mathbf{x}_t + \mathbf{a} + \mathbf{D} \mathbf{d}_t + \mathbf{H} \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R})$$
The data go from \(t=1\) to \(t=T\). For brevity, the parameter matrices are shown without a time subscript, however all parameters can be time-varying.
Note that the prediction of \(\mathbf{x}_t\) conditioned on the data up to time \(t\) is not provided since that would require the expected value of \(\mathbf{X}_{t}\) conditioned on data from \(t = 1\) to \(t+1\), which is not output from the Kalman filter or smoother."><meta property="og:image" content="https://atsa-es.github.io/MARSS/logo.png"><!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MARSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.11.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atsa-es/MARSS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Return fitted values for X(t) and Y(t) in a MARSS model</h1>
      
      <div class="d-none name"><code>fitted_marssMLE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    

<p><code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code> returns the different types of fitted values for \(\mathbf{x}_t\) and \(\mathbf{y}_t\) in a MARSS model. The fitted values are the expected value of the right side of the MARSS equations without the error terms, thus are the model predictions of \(\mathbf{y}_t\) or \(\mathbf{x}_t\). <code>fitted.marssMLE</code> is a companion function to <code><a href="tsSmooth_marssMLE.html">tsSmooth</a>()</code> which returns the expected value of the right side of the MARSS equations with the error terms (the Kalman filter and smoother output).
$$\mathbf{x}_{t} = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{C} \mathbf{c}_t + \mathbf{G} \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q})$$
$$\mathbf{y}_t = \mathbf{Z} \mathbf{x}_t + \mathbf{a} + \mathbf{D} \mathbf{d}_t + \mathbf{H} \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R})$$
The data go from \(t=1\) to \(t=T\). For brevity, the parameter matrices are shown without a time subscript, however all parameters can be time-varying.</p>
<p>Note that the prediction of \(\mathbf{x}_t\) conditioned on the data up to time \(t\) is not provided since that would require the expected value of \(\mathbf{X}_{t}\) conditioned on data from \(t = 1\) to \(t+1\), which is not output from the Kalman filter or smoother.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for marssMLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, </span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ytt1"</span>, <span class="st">"ytT"</span>, <span class="st">"xtT"</span>, <span class="st">"ytt"</span>, <span class="st">"xtt1"</span><span class="op">)</span>,   </span>
<span>    interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"confidence"</span>, <span class="st">"prediction"</span><span class="op">)</span>, </span>
<span>    level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data.frame"</span>, <span class="st">"matrix"</span><span class="op">)</span>, </span>
<span>    fun.kf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MARSSkfas"</span>, <span class="st">"MARSSkfss"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A <code><a href="marssMLE-class.html">marssMLE</a></code> object.</p></dd>

  <dt>type</dt>
<dd><p>If <code>type="tT"</code>, then the predictions are conditioned on all the data. If  <code>type="tt"</code>, then the predictions are conditioned on data up to time \(t\). If  <code>type="tt1"</code>, the predictions are conditioned on data up to time \(t-1\). The latter are also known as one-step-ahead estimates. For \(\mathbf{y}\), these are also known as the innovations.</p></dd>

  <dt>interval</dt>
<dd><p>If <code>interval="confidence"</code>, then the standard error and confidence interval of the predicted value is returned. If <code>interval="prediction"</code>, then the standard deviation and prediction interval of new data or states are returned.</p></dd>

  <dt>level</dt>
<dd><p>Level for the intervals if <code>interval</code> is not equal to <code>"none"</code>.</p></dd>

  <dt>output</dt>
<dd><p>data frame or list of matrices</p></dd>

  <dt>fun.kf</dt>
<dd><p>By default, <code><a href="tsSmooth_marssMLE.html">tsSmooth()</a></code> will use the Kalman filter/smoother function in <code>object$fun.kf</code> (either <code><a href="MARSSkf.html">MARSSkfas</a>()</code> or <code><a href="MARSSkf.html">MARSSkfss</a>()</code>). You can pass in <code>fun.kf</code> to force a particular Kalman filter/smoother function to be used.</p></dd>

  <dt>...</dt>
<dd><p>Not used.</p></dd>

  </dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>output="data.frame"</code> (the default), a data frame with the following columns is returned. If <code>output="matrix"</code>, the columns are returned as matrices in a list. Information computed from the model has a leading "." in the column name.</p>


<p>If <code>interval="none"</code>, the following are returned (colnames with <code>.</code> in front are computed values):</p>
<dl><dt>.rownames</dt>
<dd><p>Names of the data or states.</p></dd>

<dt>t</dt>
<dd><p>Time step.</p></dd>

<dt>y</dt>
<dd><p>The data if <code>type</code> is <code>"ytT"</code>, <code>"ytt"</code> or <code>"ytt1"</code>.</p></dd>

<dt>.x</dt>
<dd><p>The expected value of \(\mathbf{X}_t\) conditioned on all the data if <code>type="xtT"</code> or data up to time \(t\) if <code>type="xtt1"</code>. From <code><a href="tsSmooth_marssMLE.html">tsSmooth</a>()</code>. This is the expected value of the right-side of the \(\mathbf{x}_t\) equation with the errors terms while <code>.fitted</code> is the expected value of the right side without the error term \(\mathbf{w}_t\).</p></dd>

<dt>.fitted</dt>
<dd><p>Predicted values of observations (\(\mathbf{y}\)) or the states (\(\mathbf{x}\)). See details.</p></dd>



</dl><p>If <code>interval = "confidence"</code>, the following are also returned:</p>
<dl><dt>.se</dt>
<dd><p>Standard errors of the predictions.</p></dd>

<dt>.conf.low</dt>
<dd><p>Lower confidence level at <code>alpha = 1-level</code>. The interval is approximated using qnorm(alpha/2)*.se + .fitted</p></dd>

<dt>.conf.up</dt>
<dd><p>Upper confidence level. The interval is approximated using qnorm(1-alpha/2)*.se + .fitted</p></dd>


</dl><p>The confidence interval is for the predicted value, i.e. \(\mathbf{Z}\mathbf{x}_t^\tau+\mathbf{a}\) for \(\mathbf{y}\) or \(\mathbf{B}\mathbf{x}_{t-1}^\tau+\mathbf{u}\) for \(\mathbf{x}\) where \(\mathbf{x}_t^\tau\) is the expected value of \(\mathbf{X}_t\) conditioned on the data from 1 to \(\tau\). (\(\tau\) will be \(t-1\), \(t\) or \(T\)).</p>


<p>If <code>interval = "prediction"</code>, the following are also returned:</p>
<dl><dt>.sd</dt>
<dd><p>Standard deviation of new \(\mathbf{x}_t\) or \(\mathbf{y}_t\) iid values.</p></dd>

<dt>.lwr</dt>
<dd><p>Lower range at <code>alpha = 1-level</code>. The interval is approximated using qnorm(alpha/2)*.sd + .fitted</p></dd>

<dt>.upr</dt>
<dd><p>Upper range at <code>level</code>. The interval is approximated using qnorm(1-alpha/2)*.sd + .fitted</p></dd>


</dl><p>The prediction interval is for new \(\mathbf{x}_t\) or \(\mathbf{y}_t\). If you want to evaluate the observed data or the states estimates for outliers then these are not the intervals that you want. For that you need the residuals intervals provided by <code><a href="residuals_marssMLE.html">residuals</a>()</code>.</p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>In the state-space literature, the two most commonly used fitted values are <code>"ytt1"</code> and 
<code>"ytT"</code>. The former is the expected value of \(\mathbf{Y}_t\) conditioned on the data 1 to time \(t-1\). These are known as the innovations and they, plus their variance, are used in the calculation of the likelihood of a MARSS model via the innovations form of the likelihood. The latter, <code>"ytT"</code> are the model estimates of the \(\mathbf{y}\) values using all the data; this is the expected value of \(\mathbf{Z}\mathbf{X}_t+\mathbf{a}+\mathbf{D}\mathbf{d}_t\) conditioned on the data 1 to \(T\). The <code>"xtT"</code> along with <code>"ytT"</code> are used for computing smoothation residuals used in outlier and shock detection. See <code><a href="MARSSresiduals.html">MARSSresiduals</a></code>. For completeness, <code>fitted.marssMLE</code> will also return the other possible model predictions with different conditioning on the data (1 to \(t-1\), \(t\), and \(T\)), however only <code>type="ytt1"</code> (innovations) and <code>"ytT"</code> and <code>"xtT"</code> (smoothations) are regularly used. Keep in mind that the fitted <code>"xtT"</code> is not the smoothed estimate of \(\mathbf{x}\) (unlike <code>"ytT"</code>). If you want the smoothed estimate of \(\mathbf{x}\) (i.e. the expected value of \(\mathbf{X}_t\) conditioned on all the data), you want the Kalman smoother. See <code><a href="tsSmooth_marssMLE.html">tsSmooth</a></code>.</p>
<p>Fitted versus estimated values: The fitted states at time \(t\) are predictions from the estimated state at time \(t-1\) conditioned on the data: expected value of \(\mathbf{B}\mathbf{X}_{t-1}+\mathbf{u}+\mathbf{C}\mathbf{c}_t\) conditioned on the data. They are distinguished from the estimated states at time \(t\) which would includes the conditional expected values of the error terms: \(\textrm{E}[\mathbf{X}_{t}] = \mathbf{B}\mathbf{X}_{t-1}+\mathbf{u}+\mathbf{C}\mathbf{c}_t + \mathbf{w}_t\). The latter are returned by the Kalman filter and smoother. Analogously, the fitted observations at time \(t\) are model predictions from the estimated state at time \(t\) conditioned on the data: the expected value of the right side of the \(\mathbf{y}\) equation without the error term. Like with the states, one can also compute the expected value of the observations at time \(t\) conditioned on the data: the expected value of the right side of the \(\mathbf{y}\) equation with the error term.  The latter would just be equal to the data if there are no missing data, but when there are missing data, this is what is used to estimate their values. The expected value of states and observations are provided via <code><a href="tsSmooth_marssMLE.html">tsSmooth</a></code>.</p>
<p><strong>observation fitted values</strong></p>
<p>The model predicted \(\hat{\mathbf{y}}_t\) is \(\mathbf{Z}\mathbf{x}_t^\tau+\mathbf{a} + \mathbf{D}\mathbf{d}_t\), where \(\mathbf{x}_t^\tau\) is the expected value of the state at time \(t\) conditioned on the data from 1 to \(\tau\) (\(\tau\) will be \(t-1\), \(t\) or \(T\)). Note, if you are using MARSS for estimating the values for missing data, then you want to use <code><a href="tsSmooth_marssMLE.html">tsSmooth</a>()</code> with <code>type="ytT"</code> not <code>fitted(..., type="ytT")</code>.</p>  
<p>\(\mathbf{x}_t^\tau\) is the expected value of the states at time \(t\) conditioned on the data from time 1 to \(\tau\). If <code>type="ytT"</code>, the expected value is conditioned on all the data, i.e. <code>xtT</code> returned by <code><a href="MARSSkf.html">MARSSkf</a>()</code>.  If <code>type="ytt1"</code>, then the expected value uses only the data up to time \(t-1\), i.e. <code>xtt1</code> returned by <code><a href="MARSSkf.html">MARSSkf</a>()</code>.  These are commonly known as the one step ahead predictions for a state-space model. If <code>type="ytt"</code>, then the expected value uses the data up to time \(t\), i.e. <code>xtt</code> returned by <code><a href="MARSSkf.html">MARSSkf</a>()</code>.</p>
<p>If <code>interval="confidence"</code>, the standard error and interval is for the predicted \(\mathbf{y}\). The standard error is \(\mathbf{Z} \mathbf{V}_t^\tau \mathbf{Z}^\top\).  If <code>interval="prediction"</code>, the standard deviation of new iid \(\mathbf{y}\) data sets is returned. The standard deviation of new \(\mathbf{y}\) is \(\mathbf{Z} \mathbf{V}_t^\tau \mathbf{Z}^\top + \mathbf{R}_t\).  \(\mathbf{V}_t^\tau\) is conditioned on the data from \(t=1\) to \(n\). \(\tau\) will be either \(t\), \(t-1\) or \(T\) depending on the value of <code>type</code>.</p>
<p>Intervals returned by <code><a href="predict_marssMLE.html">predict</a>()</code> are not for the data used in the model but rather new data sets. To evaluate the data used to fit the model for residuals analysis or analysis or model inadequacy, you want the model residuals (and residual se's). Use <code><a href="residuals_marssMLE.html">residuals</a></code> for model residuals and their intervals. The intervals for model residuals are narrower because the predictions for \(\mathbf{y}\) were estimated from the model data (so is closer to the data used to estimate the predictions than new independent data will be).</p>
<p><strong>state fitted values</strong></p>
<p>The model predicted \(\mathbf{x}_t\) given \(\mathbf{x}_{t-1}\) is \(\mathbf{B}\mathbf{x}_{t-1}^\tau+\mathbf{u}+\mathbf{C}\mathbf{c}_t\). If you want estimates of the states, rather than the model predictions based on \(\mathbf{x}_{t-1}\), go to <code><a href="tsSmooth_marssMLE.html">tsSmooth</a>()</code>. Which function you want depends on your objective and application.</p>  
<p>\(\mathbf{x}_{t-1}^\tau\) used in the prediction is the expected value of the states at time \(t-1\) conditioned on the data from \(t=1\) to \(t=\tau\). If <code>type="xtT"</code>, this is the expected value at time \(t-1\) conditioned on all the data, i.e. <code>xtT[,t-1]</code> returned by <code><a href="MARSSkf.html">MARSSkf</a>()</code>.  If <code>type="xtt1"</code>, it is the expected value conditioned on the data up to time \(t-1\), i.e. <code>xtt[,t-1]</code> returned by <code><a href="MARSSkf.html">MARSSkf</a>()</code>. The predicted state values conditioned on data up to \(t\) are not provided. This would require the expected value of states at time \(t\) conditioned on data up to time \(t+1\), and this is not output by the Kalman filter. Only conditioning on data up to \(t-1\) and \(T\) are output.</p>
<p>If <code>interval="confidence"</code>, the standard error of the predicted values (meaning the standard error of the expected value of \(\mathbf{X}_t\) given \(\mathbf{X}_{t-1}\)) is returned.  The standard error of the predicted value is \(\mathbf{B} \mathbf{V}_{t-1}^\tau\mathbf{B}^\top\). If <code>interval="prediction"</code>, the standard deviation of \(\mathbf{X}_t\) given \(\mathbf{X}_{t-1}\) is output. The latter is \(\mathbf{B} \mathbf{V}_{t-1}^\tau \mathbf{B}^\top + \mathbf{Q}\) . \(\mathbf{V}_{t-1}^\tau\) is either conditioned on data 1 to \(\tau=T\) or \(\tau=t-1\) depending on <code>type</code>.</p>
<p>The intervals returned by <code>fitted.marssMLE()</code> are for the state predictions based on the state estimate at \(t-1\). These are not typically what one uses or needs--however might be useful for simulation work. If you want confidence intervals for the state estimates, those are provided in <code><a href="tsSmooth_marssMLE.html">tsSmooth</a></code>. If you want to do residuals analysis (for outliers or model inadequacy), you want the residuals intervals provided in <code><a href="residuals_marssMLE.html">residuals</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MARSSkf.html">MARSSkf</a>()</code>, <code><a href="MARSSresiduals.html">MARSSresiduals</a>()</code>, <code><a href="residuals_marssMLE.html">residuals</a>()</code>, <code><a href="predict_marssMLE.html">predict</a>()</code>, <code><a href="tsSmooth_marssMLE.html">tsSmooth</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eli Holmes, NOAA, Seattle, USA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">harborSeal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">dat</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"OR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Success! abstol and log-log tests passed at 37 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alert: conv.test.slope.tol is 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test with smaller values (&lt;0.1) to ensure convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MARSS fit is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: kem </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence test: conv.test.slope.tol = 0.5, abstol = 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation converged in 37 iterations. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 13.72233 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -11.44465   AICc: -8.918339   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.OR.SouthCoast  0.49280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R.diag           0.02509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.WA             0.06171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U.OR             0.03686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(WA,WA)        0.01082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q.(OR,OR)        0.00439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.WA            7.41712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x0.OR            6.56460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial states (x0) defined at t=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors have not been calculated. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use MARSSparamCIs to compute CIs and bias estimates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           .rownames  t        y  .fitted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  CoastalEstuaries  1 7.434848 7.478834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  CoastalEstuaries  2 7.462789 7.527291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  CoastalEstuaries  3 7.641084 7.561730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  CoastalEstuaries  4 7.851661 7.659996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  CoastalEstuaries  5       NA 7.812064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  CoastalEstuaries  6 7.959975 7.873775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  CoastalEstuaries  7 8.391176 7.984753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  CoastalEstuaries  8 8.555837 8.249960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  CoastalEstuaries  9 8.392990 8.459223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 CoastalEstuaries 10 8.343554 8.489312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 CoastalEstuaries 11 8.700847 8.481630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 CoastalEstuaries 12 8.477828 8.647625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 CoastalEstuaries 13 8.935904 8.628580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 CoastalEstuaries 14 8.824089 8.836448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 CoastalEstuaries 15 8.775704 8.892282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 CoastalEstuaries 16       NA 8.898552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 CoastalEstuaries 17 9.068892 8.960263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 CoastalEstuaries 18 8.956866 9.084143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 CoastalEstuaries 19 9.007122 9.082103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 CoastalEstuaries 20 8.663196 9.107640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 CoastalEstuaries 21 8.778326 8.957151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 CoastalEstuaries 22 8.880586 8.933726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 CoastalEstuaries 23 8.941545 8.970158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 CoastalEstuaries 24       NA 9.018261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 CoastalEstuaries 25 8.870242 9.079972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 CoastalEstuaries 26       NA 9.021653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 CoastalEstuaries 27       NA 9.083364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 CoastalEstuaries 28       NA 9.145076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 CoastalEstuaries 29       NA 9.206787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 CoastalEstuaries 30       NA 9.268498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    OR.NorthCoast  1       NA 6.601457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    OR.NorthCoast  2       NA 6.638318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    OR.NorthCoast  3 6.423247 6.675179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    OR.NorthCoast  4       NA 6.625364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    OR.NorthCoast  5       NA 6.781325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    OR.NorthCoast  6       NA 6.818186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    OR.NorthCoast  7       NA 6.855047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38    OR.NorthCoast  8 6.638568 6.891908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39    OR.NorthCoast  9 6.906755 6.906977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    OR.NorthCoast 10 6.916715 7.041783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    OR.NorthCoast 11 7.016610 7.041162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    OR.NorthCoast 12 6.898715 7.156028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    OR.NorthCoast 13 7.288244 7.159225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    OR.NorthCoast 14 7.355002 7.265265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    OR.NorthCoast 15 7.553287 7.370729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46    OR.NorthCoast 16 7.539027 7.489409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    OR.NorthCoast 17 7.424165 7.538483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    OR.NorthCoast 18 7.824446 7.538386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    OR.NorthCoast 19 7.753624 7.633471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    OR.NorthCoast 20 7.689371 7.660755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    OR.NorthCoast 21 7.553287 7.630795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52    OR.NorthCoast 22 7.677400 7.569566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53    OR.NorthCoast 23       NA 7.575025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54    OR.NorthCoast 24 7.829233 7.579818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55    OR.NorthCoast 25 7.484369 7.645344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56    OR.NorthCoast 26 7.404888 7.585838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57    OR.NorthCoast 27 7.409742 7.560004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58    OR.NorthCoast 28 7.675546 7.540157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59    OR.NorthCoast 29 7.798113 7.608532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60    OR.NorthCoast 30       NA 7.670312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61    OR.SouthCoast  1       NA 7.094258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62    OR.SouthCoast  2       NA 7.131119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63    OR.SouthCoast  3       NA 7.167980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64    OR.SouthCoast  4 7.466799 7.118166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65    OR.SouthCoast  5       NA 7.274126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66    OR.SouthCoast  6       NA 7.310987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67    OR.SouthCoast  7       NA 7.347848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68    OR.SouthCoast  8 7.573531 7.384709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69    OR.SouthCoast  9 7.786967 7.399778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70    OR.SouthCoast 10       NA 7.534584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71    OR.SouthCoast 11 7.878913 7.533963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72    OR.SouthCoast 12 7.758333 7.648829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73    OR.SouthCoast 13 7.833204 7.652026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74    OR.SouthCoast 14 7.977968 7.758067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75    OR.SouthCoast 15 8.051022 7.863530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76    OR.SouthCoast 16 7.987864 7.982210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77    OR.SouthCoast 17 7.978311 8.031284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78    OR.SouthCoast 18 8.008698 8.031188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79    OR.SouthCoast 19 7.962764 8.126272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80    OR.SouthCoast 20 7.822445 8.153556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81    OR.SouthCoast 21 7.757051 8.123597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82    OR.SouthCoast 22 7.812378 8.062367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83    OR.SouthCoast 23 7.954723 8.067827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84    OR.SouthCoast 24 7.943073 8.072620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85    OR.SouthCoast 25 7.873598 8.138145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86    OR.SouthCoast 26 7.977968 8.078639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87    OR.SouthCoast 27 7.946971 8.052805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88    OR.SouthCoast 28 8.040125 8.032958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89    OR.SouthCoast 29 8.024535 8.101333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90    OR.SouthCoast 30       NA 8.163113</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example of fitting a stochastic level model to the Nile River flow data</span></span></span>
<span class="r-in"><span><span class="co"># red line is smooothed level estimate</span></span></span>
<span class="r-in"><span><span class="co"># grey line is one-step-ahead prediction using xtt1</span></span></span>
<span class="r-in"><span><span class="va">nile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Nile.html" class="external-link">Nile</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"r"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, Q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"q"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"pi"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="MARSS.html">MARSS</a></span><span class="op">(</span><span class="va">nile</span>, model <span class="op">=</span> <span class="va">mod.list</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting</span></span></span>
<span class="r-in"><span><span class="co"># There are plot methods for marssMLE objects</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitted_marssMLE-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = xtT </span>
<span class="r-plt img"><img src="fitted_marssMLE-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = fitted.ytT </span>
<span class="r-plt img"><img src="fitted_marssMLE-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = model.resids.ytt1 </span>
<span class="r-plt img"><img src="fitted_marssMLE-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = std.model.resids.ytT </span>
<span class="r-plt img"><img src="fitted_marssMLE-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = std.state.resids.xtT </span>
<span class="r-plt img"><img src="fitted_marssMLE-10.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-11.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = qqplot.std.model.resids.ytt1 </span>
<span class="r-plt img"><img src="fitted_marssMLE-12.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-13.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = qqplot.std.state.resids.xtT </span>
<span class="r-plt img"><img src="fitted_marssMLE-14.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hit &lt;Return&gt; to see next plot (q to exit): </span>
<span class="r-plt img"><img src="fitted_marssMLE-15.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.type = acf.std.model.resids.ytt1 </span>
<span class="r-plt img"><img src="fitted_marssMLE-16.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished plots.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Below shows how to make plots manually but all of these can be made</span></span></span>
<span class="r-in"><span><span class="co"># with autoplot(fit) or plot(fit)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nile</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"ytT"</span><span class="op">)</span><span class="op">$</span><span class="va">.fitted</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"ytt1"</span><span class="op">)</span><span class="op">$</span><span class="va">.fitted</span>, col <span class="op">=</span> <span class="st">"grey"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitted_marssMLE-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make a plot of the model estimate of y(t), i.e., put a line through the points</span></span></span>
<span class="r-in"><span><span class="co"># Intervals are for new data not the blue dots </span></span></span>
<span class="r-in"><span><span class="co"># (which were used to fit the model so are not new)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"ytT"</span>, interval<span class="op">=</span><span class="st">"confidence"</span>, level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"ytT"</span>, interval<span class="op">=</span><span class="st">"prediction"</span>, level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">.lwr</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">.lwr</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">.upr</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">.upr</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">.fitted</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, ymin <span class="op">=</span> <span class="va">.conf.low</span>, ymax <span class="op">=</span> <span class="va">.conf.up</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">.lwr</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">.upr</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">.rownames</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time Step"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Blue=data, Black=estimate, grey=CI, dash=prediction interval"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">15</span>, y<span class="op">=</span><span class="fl">7</span>, label<span class="op">=</span><span class="st">"The intervals are for \n new data not the blue dots"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitted_marssMLE-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Eli Holmes, Eric J. Ward, Mark D. Scheuerell, Kellie Wills.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

